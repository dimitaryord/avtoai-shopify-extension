"use strict";function t(t=null,e){const s="light"===e?"#fefefe":"#222831",a="light"===e?"#000000aa":"#ffffffab",n="light"===e?"#d1d1d1":"#393e46",i="light"===e?"#f6f6f7":"#353d3e",o="light"===e?"black":"white",r=function(t){if(!t)return;t=t.substring(1);let e=parseInt(t,16);return.2126*(e>>16&255)+.7152*(e>>8&255)+.0722*(e>>0&255)>150}(t)?"black":"white",c="light"===e?"white":"black";t&&document.documentElement.style.setProperty("--avtoai-assistant-colors-color-theme",t),document.documentElement.style.setProperty("--avtoai-assistant-colors-app-theme",s),document.documentElement.style.setProperty("--avtoai-assistant-colors-widget-button-shadow",a),document.documentElement.style.setProperty("--avtoai-assistant-colors-color-border-shadow",n),document.documentElement.style.setProperty("--avtoai-assistant-colors-message-assistant-bg",i),document.documentElement.style.setProperty("--avtoai-assistant-colors-text-color",o),t&&document.documentElement.style.setProperty("--avtoai-assistant-colors-color-theme-text-color",r),document.documentElement.style.setProperty("--avtoai-assistant-colors-text-shadow",c)}const e={designComponent:(t,{classes:e,style:s,id:a,text:n})=>(e&&t.classList.add(...e),s&&Object.assign(t.style,s),a&&(t.id=a),n&&(t.textContent=n),t.clone=e=>{const s=[];for(let a=0;a<e;a++)s.push(t.cloneNode(!0));return s.to=t=>(t&&s.forEach((e=>t.appendChild(e))),s),s},t.to=e=>(e&&e.appendChild(t),t),t),div:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("div");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},span:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("span");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},a:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("a");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},h1:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("h1");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},h2:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("h2");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},h3:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("h3");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},h4:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("h4");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},h5:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("h5");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},h6:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("h6");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},p:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("p");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},label:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("label");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},button:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("button");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},input:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("input");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},textarea:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("textarea");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},select:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("select");return e.designComponent(i,{classes:t,style:s,id:a,text:n})},option:({classes:t,style:s,id:a,text:n})=>{const i=document.createElement("option");return e.designComponent(i,{classes:t,style:s,id:a,text:n})}};Object.freeze(e);class s{constructor(t,e){t&&t.appendChild(e)}playElementAnimation(t,e,s){t.style.animation="",t.offsetWidth,t.style.animation=e+" "+s}}class a extends s{constructor({container:t,position:s}){const a=e.div({id:"avtoai-assistant-side-drawer-container"}),n=e.div({id:"avtoai-assistant-side-drawer-blur",classes:["avtoai-assistant-side-drawer-blur"],style:{display:"block",right:"right"===s?"0px":null,left:"left"===s?"0px":null}}).to(a),i=e.div({id:"avtoai-assistant-side-drawer",classes:["avtoai-assistant-side-drawer"],style:{right:"right"===s?"10px":null,left:"left"===s?"10px":null,transform:"left"===s?"translate(-110%, -50%)":"right"===s?"translate(110%, -50%)":null}}).to(a);super(t,a),this.side=s,this.isOpen=!1,this.sideDrawerBlur=n,this.content=i,document.addEventListener("click",(t=>{t.target==n&&this.close()}))}close(){this.isOpen=!1,this.playAnimation("reverse")}open(){this.isOpen=!0,this.playAnimation()}playAnimation(t="normal"){this.playElementAnimation(this.sideDrawerBlur,"avtoai-assistant-slide-blur 0.2s forwards",t),this.playElementAnimation(this.content,`avtoai-assistant-slide-drawer-${this.side} 0.4s ease-out forwards`,t)}}var n=(t,e,s)=>`<svg loading="lazy" viewBox="0 0 16 16" width="${s}" height="${e}" xmlns="http://www.w3.org/2000/svg" fill="none" class="hds-flight-icon--animation-loading"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g fill="${t}" fill-rule="evenodd" clip-rule="evenodd"> <path d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8z" opacity=".2"></path> <path d="M7.25.75A.75.75 0 018 0a8 8 0 018 8 .75.75 0 01-1.5 0A6.5 6.5 0 008 1.5a.75.75 0 01-.75-.75z"></path> </g> </g></svg>`;class i{constructor({container:t,assistantName:s,assistantImage:a,startInLoading:n}){const i=e.div({id:"avtoai-assistant-chat-header",classes:["avtoai-assistant-chat-header"]}),o=e.div({id:"avtoai-assistant-chat-header-container",style:{display:"flex",width:"100%",alignItems:"center"}}),r=e.div({id:"avtoai-assistant-chat-close-button-container",style:{display:"flex",flexGrow:"1",justifyContent:"end",alignItems:"center"}});i.appendChild(o),t&&t.appendChild(i);const c=this.createMenu(),l=e.div({id:"avtoai-assistant-header-close-button",classes:["avtoai-assistant-button-opacity-hover"],style:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"}});l.innerHTML=`\n<?xml version="1.0" encoding="utf-8"?>\n<svg width="${"40px"}" height="${"25px"}" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g id="Menu / Close_LG">\n<path id="Vector" d="M21 21L12 12M12 12L3 3M12 12L21.0001 3M12 12L3 21.0001" stroke="${"var(--avtoai-assistant-colors-color-theme-text-color)"}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n</g>\n</svg>\n`,r.appendChild(l);const{titleContainer:d,titleText:h}=this.createTitle(s,a);o.appendChild(c),n||o.appendChild(d),o.appendChild(r),this.content=o,this.titleContainer=d,this.title=h,this.closeButtonContainer=r,this.closeButton=l,this.menuButton=c}createMenu(){const t=e.div({id:"avtoai-assistant-chat-menu-container",classes:["avtoai-assistant-chat-menu-container"]});return e.div({classes:["avtoai-assistant-chat-menu-dot"],style:{display:"block"}}).clone(3).to(t),t}createTitle(t,s){const a=e.div({id:"avtoai-assistant-chat-title-container",classes:["avtoai-assistant-chat-title-container"]}),n=e.div({id:"avtoai-assistant-chat-title-block",style:{display:"flex",alignItems:"center",paddingRight:"2rem"}}),i=document.createElement("img");i.loading="lazy",i.src=s,i.alt="avtoai-assistant-chat-bot-icon";const o=e.designComponent(i,{style:{width:"50px",height:"50px",borderRadius:"10px",filter:"drop-shadow(0px 0px 1px var(--avtoai-assistant-colors-color-theme-text-color))"}}),r=e.h3({classes:["avtoai-assistant-chat-title-text"],text:t});return n.appendChild(o),n.appendChild(r),a.appendChild(n),{titleContainer:a,titleText:r}}setTitle(t){this.title.textContent=t}switchToReady(){this.content.insertBefore(this.titleContainer,this.closeButtonContainer),e.designComponent(this.closeButtonContainer,{style:{flexGrow:"0",justifyContent:"center"}})}switchToLoading(){this.content.removeChild(this.titleContainer),e.designComponent(this.closeButtonContainer,{style:{flexGrow:"1",justifyContent:"end"}})}}class o{constructor(t){const s=e.div({id:"avtoai-assistant-chat-section",style:{flexGrow:"1",display:"flex",overflowY:"hidden"}}),a=e.div({id:"avtoai-assistant-chat-section-greeting-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexGrow:"1",height:"80%"}}),n=e.div({id:"avtoai-assistant-chat-section-greeting-button",style:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",width:"100px",height:"100px",background:"rgba(137, 134, 134, 0.3)",borderRadius:"50%",boxShadow:"0 4px 30px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(20px)"}}),i=document.createElement("img");i.loading="lazy",i.src=t,i.alt="avtoai-assistant-chat-section-greeting-icon";const o=e.designComponent(i,{style:{width:"85px",height:"85px",borderRadius:"50%"}}),r=e.h3({id:"avtoai-assistant-chat-section-greeting-title",style:{textAlign:"center",color:"var(--avtoai-assistant-colors-text-color)",fontWeight:"bold",marginBlock:"0",marginTop:"2rem",fontFamily:"'Roboto Slab', sans-serif"},text:"How can i assist you with this store?"}),c=e.p({id:"avtoai-assistant-chat-section-greeting-body",style:{fontSize:"1rem",fontWeight:"bold",marginTop:"0.5rem",color:"var(--avtoai-assistant-colors-text-color)"},text:"Powered by Avto"});a.appendChild(n),n.appendChild(o),a.appendChild(r),a.appendChild(c);const l=e.div({id:"avtoai-assistant-chat-section-container",classes:["avtoai-assistant-chat-scrollbar"],style:{display:"flex",overflowY:"auto",flexDirection:"column",flexGrow:"1",alignItems:"flex-start",padding:"1.25rem"}});s.appendChild(a),this.element=s,this.greetingContainer=a,this.content=l,this.view="greeting"}startChat(){"greeting"===this.view&&(this.element.removeChild(this.greetingContainer),this.element.appendChild(this.content),this.view="chat")}}class r{constructor(t){const s=e.div({id:"avtoai-assistant-actions-container",classes:["avtoai-assistant-action-section-container"],style:{display:"flex"}}),a=e.div({id:"avtoai-assistant-actions-starters-button-container",classes:["avtoai-assistant-actions-starters-button-container"]}).to(s),n=`<?xml version="1.0" encoding="utf-8"?>\n\n<svg fill="${"var(--avtoai-assistant-colors-color-theme-text-color)"}" width="30px" height="30px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n\n<g data-name="Layer 2">\n\n<g data-name="question-mark">\n\n<rect width="24" height="24" transform="rotate(180 12 12)" opacity="0"/>\n\n<path d="M17 9A5 5 0 0 0 7 9a1 1 0 0 0 2 0 3 3 0 1 1 3 3 1 1 0 0 0-1 1v2a1 1 0 0 0 2 0v-1.1A5 5 0 0 0 17 9z"/>\n\n<circle cx="12" cy="19" r="1"/>\n\n</g>\n\n</g>\n\n</svg>`;const i=(t=>`<?xml version="1.0" encoding="utf-8"?>\n<svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10.4606 1.25H13.5394C15.1427 1.24999 16.3997 1.24999 17.4039 1.34547C18.4274 1.44279 19.2655 1.64457 20.0044 2.09732C20.7781 2.57144 21.4286 3.22194 21.9027 3.99563C22.3554 4.73445 22.5572 5.57256 22.6545 6.59611C22.75 7.60029 22.75 8.85725 22.75 10.4606V11.5278C22.75 12.6691 22.75 13.564 22.7007 14.2868C22.6505 15.0223 22.5468 15.6344 22.3123 16.2004C21.7287 17.6093 20.6093 18.7287 19.2004 19.3123C18.3955 19.6457 17.4786 19.7197 16.2233 19.7413C15.7842 19.7489 15.5061 19.7545 15.2941 19.7779C15.096 19.7999 15.0192 19.832 14.9742 19.8582C14.9268 19.8857 14.8622 19.936 14.7501 20.0898C14.6287 20.2564 14.4916 20.4865 14.2742 20.8539L13.7321 21.7697C12.9585 23.0767 11.0415 23.0767 10.2679 21.7697L9.72579 20.8539C9.50835 20.4865 9.37122 20.2564 9.24985 20.0898C9.13772 19.936 9.07313 19.8857 9.02572 19.8582C8.98078 19.832 8.90399 19.7999 8.70588 19.7779C8.49387 19.7545 8.21575 19.7489 7.77666 19.7413C6.52138 19.7197 5.60454 19.6457 4.79957 19.3123C3.39066 18.7287 2.27128 17.6093 1.68769 16.2004C1.45323 15.6344 1.3495 15.0223 1.29932 14.2868C1.24999 13.564 1.25 12.6691 1.25 11.5278L1.25 10.4606C1.24999 8.85726 1.24999 7.60029 1.34547 6.59611C1.44279 5.57256 1.64457 4.73445 2.09732 3.99563C2.57144 3.22194 3.22194 2.57144 3.99563 2.09732C4.73445 1.64457 5.57256 1.44279 6.59611 1.34547C7.60029 1.24999 8.85726 1.24999 10.4606 1.25ZM6.73809 2.83873C5.82434 2.92561 5.24291 3.09223 4.77938 3.37628C4.20752 3.72672 3.72672 4.20752 3.37628 4.77938C3.09223 5.24291 2.92561 5.82434 2.83873 6.73809C2.75079 7.663 2.75 8.84876 2.75 10.5V11.5C2.75 12.6751 2.75041 13.5189 2.79584 14.1847C2.84081 14.8438 2.92737 15.2736 3.07351 15.6264C3.50486 16.6678 4.33223 17.4951 5.3736 17.9265C5.88923 18.1401 6.54706 18.2199 7.8025 18.2416L7.83432 18.2421C8.23232 18.249 8.58109 18.2549 8.87097 18.287C9.18246 18.3215 9.4871 18.3912 9.77986 18.5615C10.0702 18.7304 10.2795 18.9559 10.4621 19.2063C10.6307 19.4378 10.804 19.7306 11.0004 20.0623L11.5587 21.0057C11.7515 21.3313 12.2485 21.3313 12.4412 21.0057L12.9996 20.0623C13.1959 19.7306 13.3692 19.4378 13.5379 19.2063C13.7204 18.9559 13.9298 18.7304 14.2201 18.5615C14.5129 18.3912 14.8175 18.3215 15.129 18.287C15.4189 18.2549 15.7676 18.249 16.1656 18.2421L16.1975 18.2416C17.4529 18.2199 18.1108 18.1401 18.6264 17.9265C19.6678 17.4951 20.4951 16.6678 20.9265 15.6264C21.0726 15.2736 21.1592 14.8438 21.2042 14.1847C21.2496 13.5189 21.25 12.6751 21.25 11.5V10.5C21.25 8.84876 21.2492 7.663 21.1613 6.73809C21.0744 5.82434 20.9078 5.24291 20.6237 4.77938C20.2733 4.20752 19.7925 3.72672 19.2206 3.37628C18.7571 3.09223 18.1757 2.92561 17.2619 2.83873C16.337 2.75079 15.1512 2.75 13.5 2.75H10.5C8.84876 2.75 7.663 2.75079 6.73809 2.83873ZM7.25 9C7.25 8.58579 7.58579 8.25 8 8.25H16C16.4142 8.25 16.75 8.58579 16.75 9C16.75 9.41421 16.4142 9.75 16 9.75H8C7.58579 9.75 7.25 9.41421 7.25 9ZM7.25 12.5C7.25 12.0858 7.58579 11.75 8 11.75H13.5C13.9142 11.75 14.25 12.0858 14.25 12.5C14.25 12.9142 13.9142 13.25 13.5 13.25H8C7.58579 13.25 7.25 12.9142 7.25 12.5Z" fill="${t}"/>\n</svg>`)("var(--avtoai-assistant-colors-color-theme-text-color)");a.innerHTML=n;const o=e.div({id:"avtoai-assistant-actions-input-container",classes:["avtoai-assistant-actions-input-container"]}).to(s),r=e.textarea({id:"avtoai-assistant-actions-input",classes:["avtoai-assistant-actions-input","avtoai-assistant-textarea-scrollbar"]}).to(o);r.placeholder="Chat here...",this.setHeightAuto=()=>{r.style.height>r.style.maxHeight?r.style.overflowY="scroll":r.style.height<r.style.maxHeight&&(r.style.overflowY="hidden"),r.value.includes("\n")||39!==r.scrollHeight&&51!==r.scrollHeight?(r.style.height="auto",r.style.height=r.scrollHeight+"px",r.scrollTo(0,r.scrollHeight)):r.style.height=null,0!==r.value.trim().length?c.style.display="flex":(c.style.display="none",r.value.includes("\n")||(r.style.height=null))},r.addEventListener("input",this.setHeightAuto,!1);const c=e.div({id:"avtoai-assistant-actions-send-button",classes:["avtoai-assistant-actions-send","avtoai-assistant-actions-send-enabled"],style:{display:"none"}}).to(o);c.innerHTML=((t,e)=>`<svg loading="lazy" class="${e}" viewBox="0 0 24 24" fill="${t}" xmlns="http://www.w3.org/2000/svg">\n    <path d="M6.99811 10.2467L7.43298 11.0077C7.70983 11.4922 7.84825 11.7344 7.84825 12C7.84825 12.2656 7.70983 12.5078 7.43299 12.9923L7.43298 12.9923L6.99811 13.7533C5.75981 15.9203 5.14066 17.0039 5.62348 17.5412C6.1063 18.0785 7.24961 17.5783 9.53623 16.5779L15.8119 13.8323C17.6074 13.0468 18.5051 12.654 18.5051 12C18.5051 11.346 17.6074 10.9532 15.8119 10.1677L9.53624 7.4221C7.24962 6.42171 6.1063 5.92151 5.62348 6.45883C5.14066 6.99615 5.75981 8.07966 6.99811 10.2467Z"/>\n</svg>`)("var(--avtoai-assistant-colors-text-color)","avtoai-assistant-actions-send-icon");const l=this.createStarters(t);this.mode="chat",this.input=r,this.sendButton=c,this.content=s,this.starters=Array.from(l.children),this.startersContent=l,a.onclick=()=>{"chat"===this.mode?(s.removeChild(o),s.appendChild(this.startersContent),a.innerHTML=i,this.mode="starters"):"starters"===this.mode&&(s.removeChild(this.startersContent),s.appendChild(o),a.innerHTML=n,this.mode="chat")},r.onfocus=()=>{s.contains(a)&&(s.removeChild(a),o.style.left="0px")},r.onblur=()=>{s.contains(this.startersContent)?s.insertBefore(a,this.startersContent):s.contains(o)&&s.insertBefore(a,o),o.style.left="0.5rem"}}setStarters(t){const e=this.createStarters(t);this.content.contains(this.startersContent)&&(this.content.insertBefore(e,this.startersContent),this.content.removeChild(this.startersContent)),this.starters=Array.from(e.children),this.startersContent=e}createStarters(t){const s=e.div({id:"avtoai-assistant-chat-actions-starters-container",classes:["avtoai-assistant-chat-scrollbar"],style:{width:"90%",flexGrow:"1",display:"flex",overflowY:"hidden",overflowX:"auto",gap:".25rem",paddingBlock:".5rem",marginInline:".5rem"}});s.addEventListener("wheel",(t=>{t.preventDefault(),s.scrollLeft+=.5*t.deltaY}));for(let a of t.filter((t=>""!==t.trim()))){const t=e.div({id:"avtoai-assistant-chat-actions-starter",classes:["avtoai-assistant-chat-actions-starter"],style:{cursor:"pointer",display:"flex",alignItems:"center",height:"50px",textWrap:"nowrap",width:"fit-content",padding:"1rem",fontSize:"14px",borderRadius:"25px",color:"var(--avtoai-assistant-colors-color-theme-text-color)",backgroundColor:"var(--avtoai-assistant-colors-color-theme)",border:"var(--avtoai-assistant-colors-widget-box-border) solid 1px",boxShadow:"var(--avtoai-assistant-colors-color-border-shadow) 0.1rem 0.1rem"},text:a});s.appendChild(t)}return s}}class c{constructor(s,{defaultTheme:a}){const n=e.div({id:"avtoai-assistant-app-settings-container",style:{flexGrow:"1",padding:"5rem"}}),i=e.div({id:"avtoai-assistant-app-settings-title-container",style:{display:"flex",width:"100%",alignItems:"center",marginBottom:"5rem"}}).to(n),o=e.button({id:"avtoai-assistant-app-settings-title-back-button",classes:["avtoai-assistant-button-opacity-hover"],style:{marginRight:"1rem",background:"transparent",padding:"0",border:"none",outline:"none",cursor:"pointer"}}).to(i);o.innerHTML=`<?xml version="1.0" ?>\n\n<svg width="50px" height="25px" viewBox="0 0 512 512" version="1.1" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\n<g id="Layer_1"/>\n\n<g id="Layer_2">\n\n<g>\n\n<path style="fill:${"var(--avtoai-assistant-colors-text-color)"};" d="M217,129.88c-6.25-6.25-16.38-6.25-22.63,0L79.61,244.64c-0.39,0.39-0.76,0.8-1.11,1.23    c-0.11,0.13-0.2,0.27-0.31,0.41c-0.21,0.28-0.42,0.55-0.62,0.84c-0.14,0.21-0.26,0.43-0.39,0.64c-0.14,0.23-0.28,0.46-0.41,0.7    c-0.13,0.24-0.24,0.48-0.35,0.73c-0.11,0.23-0.22,0.45-0.32,0.68c-0.11,0.26-0.19,0.52-0.28,0.78c-0.08,0.23-0.17,0.46-0.24,0.69    c-0.09,0.29-0.15,0.58-0.22,0.86c-0.05,0.22-0.11,0.43-0.16,0.65c-0.08,0.38-0.13,0.76-0.17,1.14c-0.02,0.14-0.04,0.27-0.06,0.41    c-0.11,1.07-0.11,2.15,0,3.22c0.01,0.06,0.02,0.12,0.03,0.18c0.05,0.46,0.12,0.92,0.21,1.37c0.03,0.13,0.07,0.26,0.1,0.39    c0.09,0.38,0.18,0.76,0.29,1.13c0.04,0.13,0.09,0.26,0.14,0.4c0.12,0.36,0.25,0.73,0.4,1.09c0.05,0.11,0.1,0.21,0.15,0.32    c0.17,0.37,0.34,0.74,0.53,1.1c0.04,0.07,0.09,0.14,0.13,0.21c0.21,0.38,0.44,0.76,0.68,1.13c0.02,0.03,0.04,0.06,0.06,0.09    c0.55,0.81,1.18,1.58,1.89,2.29l114.81,114.81c3.12,3.12,7.22,4.69,11.31,4.69s8.19-1.56,11.31-4.69c6.25-6.25,6.25-16.38,0-22.63    l-87.5-87.5h291.62c8.84,0,16-7.16,16-16s-7.16-16-16-16H129.51L217,152.5C223.25,146.26,223.25,136.13,217,129.88z"/>\n\n</g>\n\n</g>\n\n</svg>`,o.onclick=s,e.h2({id:"avtoai-assistant-app-settings-title",style:{color:"var(--avtoai-assistant-colors-text-color)"},text:"Settings"}).to(i);const r=e.div({id:"avtoai-assistant-app-settings-theme-container",style:{display:"flex",alignItems:"center"}}).to(n);this.currentTheme=a,e.p({id:"avtoai-assistant-app-settings-text",style:{color:"var(--avtoai-assistant-colors-text-color)",flexGrow:"1",width:"100%"},text:`Theme (Default: ${"light"===a?"Light":"Dark"})`}).to(r);const c=e.div({id:"avtoai-assistant-app-settings-label-container",style:{display:"flex",justifyContent:"end",alignItems:"center"}}).to(r),l=e.label({id:"avtoai-assistant-app-settings-label",classes:["avtoai-assistant-app-settings-switch"]}).to(c),d=e.input({id:"avtoai-assistant-app-settings-checkbox",classes:["avtoai-assistant-app-settings-input"]}).to(l);d.type="checkbox",d.onclick=()=>{this.currentTheme="light"===this.currentTheme?"dark":"light",t(null,this.currentTheme)},e.span({id:"avtoai-assistant-app-settings-slider",classes:["avtoai-assistant-app-settings-slider"]}).to(l);const h=e.div({id:"avtoai-assistant-app-settings-font-size-container",style:{display:"flex",alignItems:"center"}}).to(n);e.p({id:"avtoai-assistant-app-settings-text",style:{color:"var(--avtoai-assistant-colors-text-color)",flexGrow:"1",width:"100%"},text:"Chat Font Size"}).to(h);const p=e.select({id:"avtoai-assistant-app-settings-select",style:{background:"transparent",borderRadius:"10px",padding:"1rem",outlineColor:"var(--avtoai-assistant-colors-color-theme)",color:"var(--avtoai-assistant-colors-text-color)"}}).to(h);p.addEventListener("change",(t=>{var e;t.preventDefault(),e=t.target.value,Number(e)>=10&&Number(e)<=24&&document.documentElement.style.setProperty("--avtoai-assistant-chat-app-message-font-size",e+"px")}));const g=[10,12,14,16,18,20,24];for(let t of g){const s=e.option({id:"avtoai-assistant-app-settings-option",style:{backgroundColor:"var(--avtoai-assistant-colors-app-theme)",fontSize:"1.75rem"},text:t}).to(p);s.value=t,16===t&&(s.selected="selected")}this.content=n}}class l{constructor(t,{defaultPage:e=""}){this.appContainer=t,this.defaultPage=e,this.currentPage=e,this.lastPage=null,this.pages={}}createPage(t,...e){if(this.pages[t]=e,t===this.defaultPage)for(let t of e)this.appContainer.appendChild(t)}changePage(t){if(this.pages.hasOwnProperty(t)&&this.currentPage!==t){for(let t of this.pages[this.currentPage])this.appContainer.removeChild(t);for(let e of this.pages[t])this.appContainer.appendChild(e);this.lastPage=this.currentPage,this.currentPage=t}}back(){if(this.lastPage){for(let t of this.pages[this.currentPage])this.appContainer.removeChild(t);for(let t of this.pages[this.lastPage])this.appContainer.appendChild(t);this.currentPage=this.lastPage,this.lastPage=null}}}class d{constructor({drawer:t,assistantName:e,assistantStarters:s=[],assistantImage:a,startInLoading:n=!0,disableForMessageSent:d=!0},{defaultTheme:h}){this.pageEngine=new l(t.content,{defaultPage:n?"loading":"chat"});const p=new c((()=>this.pageEngine.back()),{defaultTheme:h});this.pageEngine.createPage("settings",p.content);const g=new i({container:t.content,assistantName:e,assistantImage:a,startInLoading:n});g.closeButton.onclick=()=>t.close(),g.menuButton.onclick=()=>{"chat"===this.pageEngine.currentPage?this.pageEngine.changePage("settings"):"settings"===this.pageEngine.currentPage&&this.pageEngine.changePage("chat")};const u=this.createLoadingComponent();this.pageEngine.createPage("loading",u);const m=new o(a),v=new r(s);this.pageEngine.createPage("chat",m.element,v.content),this.container=t.content,this.loading=n,this.disableForMessageSent=d,this.sections={headerSection:g,chatSection:m,actionSection:v},this.loadingComponent=u,this.runStatus="completed",v.sendButton.onclick=t=>this.onSend(t,v);for(let t of v.starters)t.onclick=e=>this.onSend(e,v,t.textContent);v.input.addEventListener("keydown",(async t=>{if(!t.shiftKey||"Enter"!==t.key&&13!==t.keyCode)"Enter"===t.key&&this.onSend(t,v);else{t.preventDefault();const e=v.input.selectionStart,s=v.input.selectionEnd;v.input.value=v.input.value.substring(0,e)+"\n"+v.input.value.substring(s),v.input.selectionStart=v.input.selectionEnd=e+1,v.setHeightAuto()}}))}setStarters(t){this.sections.actionSection.setStarters(t);for(let t of this.sections.actionSection.starters)t.onclick=e=>this.onSend(e,this.sections.actionSection,t.textContent)}setTitle(t){this.sections.headerSection.setTitle(t)}messageSentReady(){this.runStatus="completed",this.sections.actionSection.sendButton.disabled=!1,this.sections.actionSection.sendButton.classList.add("avtoai-assistant-actions-send-enabled"),this.sections.actionSection.sendButton.style.display="none"}messageSentStarted(){this.runStatus="in_process",this.sections.actionSection.sendButton.disabled=!0,this.sections.actionSection.sendButton.classList.remove("avtoai-assistant-actions-send-enabled"),this.sections.chatSection.startChat()}switchToReady(){this.loading&&(this.sections.headerSection.switchToReady(),this.pageEngine.changePage("chat"),this.loading=!1)}switchToLoading(){this.loading||(this.sections.headerSection.switchToLoading(),this.pageEngine.changePage("loading"),this.loading=!0)}createLoadingComponent(){const t=e.div({id:"avtoai-assistant-chat-app-loading-container",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}});return e.div({id:"avtoai-assistant-chat-app-loading",style:{animation:"avtoai-assistant-spin 2s linear infinite",height:"60px"}}).to(t).innerHTML=n("var(--avtoai-assistant-colors-color-theme)","60px","60px"),t}async onMessageSent(t){}async onSend(t,e,s){t&&t.preventDefault();const a=s||e.input.value.trim();a.length>0&&this.onMessageSent&&"completed"===this.runStatus&&(this.messageSentStarted(),e.input.value="",e.setHeightAuto(),await this.onMessageSent(a),this.disableForMessageSent&&this.messageSentReady())}}const h=new class{constructor(){this.staticUrl="/apps/server",this.config={method:"GET",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"}}}async get(t){try{this.config.method="GET",this.config.body=null;const e=await fetch(`${this.staticUrl}${t}`,this.config);if(e.ok){return await e.json()}const s=await e.json();console.error({error:s})}catch(t){console.log(t),console.error(t.message)}}async post(t,e={}){try{this.config.method="POST",this.config.body=JSON.stringify(e);const s=await fetch(`${this.staticUrl}${t}`,this.config);if(s.ok){return await s.json()}const a=await s.json();console.error({error:a})}catch(t){console.log(t),console.error(t.message)}}};function p(t,e,s=null){if("function"==typeof e){let a=g(t);a||(a=s),sessionStorage.setItem(t,JSON.stringify(e(a)))}else e&&sessionStorage.setItem(t,JSON.stringify(e))}function g(t){const e=sessionStorage.getItem(t);return e?JSON.parse(e):null}function u(t){let e=t.innerHTML.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/\*\*(.*)\*\*/gim,"<strong>$1</strong>").replace(/\*(.*)\*/gim,"<em>$1</em>").replace(/\[([^\]]+)\]\(([^)]+)\)/gim,'<a style="color:black" href="$2">$1</a>');e=e.replace(/\n/g,"<br>"),t.innerHTML=e}class m{static lastMessageType="empty";constructor(t,s,a,{paddingBlock:n=!1,paddingInline:i=!0,border:o=!1}){const r=e.div({id:"avtoai-assistant-message-container",style:{maxWidth:"90%",borderRadius:"10px",border:o?"1px solid var(--avtoai-assistant-colors-text-color)":"none",paddingInline:i?"1.25em":"0px",paddingBlock:n?"1em":"0px",marginTop:"empty"===m.lastMessageType?"0em":"assistant"===m.lastMessageType&&"assistant"===s?"0.5em":"1em",alignSelf:"assistant"===s?"flex-start":"flex-end",backgroundColor:"assistant"===s?"var(--avtoai-assistant-colors-message-assistant-bg)":"var(--avtoai-assistant-colors-color-theme)"}});m.lastMessageType=s;const c=e.p({id:"avtoai-assistant-message",style:{color:"assistant"===s?"var(--avtoai-assistant-colors-text-color)":"var(--avtoai-assistant-colors-color-theme-text-color)",fontSize:"var(--avtoai-assistant-chat-app-message-font-size)"},text:t});r.appendChild(c),a&&(this.innerContent=a,r.appendChild(a)),this.content=r,this.textElement=c,this.text=c.textContent}isEmpty(){return""===this.text.trim()&&this.content.contains(this.innerContent)}updateMessage(t){this.content.contains(this.innerContent)&&(this.content.removeChild(this.innerContent),e.designComponent(this.content,{style:{paddingInline:"1.25em",paddingBlock:"0px"}})),"string"==typeof t?(this.textElement.textContent=t,this.text=t):"function"==typeof t&&(this.textElement.textContent=t(this.text),this.text=t(this.text)),u(this.textElement)}updateInnerContent(t){this.content.contains(this.innerContent)&&this.content.removeChild(this.innerContent),this.content.appendChild(t),this.innerContent=t}}class v extends m{constructor(t,e,s){super(e,s,null,{}),t.appendChild(this.content)}}async function x({productHandle:t,variantIds:e}){try{const s=await fetch(`/products/${t}.js`);if(!s.ok)return console.error(`Failed to fetch product: ${s.statusText}`),null;const a=await s.json(),n=e&&e.length>0?a.variants.filter((t=>e.includes(t.id))):null;let i=[];return a.variants.forEach((t=>{let e=t&&t.featured_image?t.featured_image.src:null;e||(a.featured_image?e=a.featured_image:a.images.length>0&&(e=a.images[0])),i.push({displayName:t.name?t.name:a.title,id:t.id,options:t.options,price:t.price?t.price/100:a.price/100,imageUrl:e?e.startsWith("https:")?e:`https:${e}`:null})})),{productHandle:t,defaultVariantId:n&&n[0]?n[0].id:null,variants:i,options:a.options}}catch(e){return console.error(`Error fetching product details for handle "${t}": ${e.message}`),null}}async function f(t){if(0===t.trim().length)return[];const e=function(t,e){const s=t.replaceAll(":"," : "),a=/[",',\s,{,\\[]variant_id[",',\s]\s*:\s*[",',\s].*?\/(\d+)[",',\s,},\]]|[",',\s,{,\\[]id[",',\s]\s*:\s*[",',\s].*?\/(\d+)[",',\s,},\]]/g,n=/[",',\s,{,\\[](product_handle|handle)[",',\s]\s*:\s*[",',\s](.*?-.+?)[",',\s,},\]]/g,i=new Set,o=new Set;let r;for(;null!==(r=n.exec(s));)i.add(r[2]);for(;null!==(r=a.exec(s));){const t=r[1]?parseInt(r[1],10):parseInt(r[2],10);isNaN(t)||o.add(t)}return Array.from(i).map((t=>e({productHandle:t,variantIds:Array.from(o)}).catch((()=>null))))}(t,x);return(await Promise.all(e)).filter((t=>null!==t)).slice(0,10)}class y extends m{constructor(t,{productHandle:s,defaultVariantId:a,variants:n,options:i},o=null){const r=a?n.find((t=>t.id===a)):n[0],c=e.div({id:"avtoai-assistant-chat-app-product-info-message"});super("","assistant",c,{paddingInline:!1,border:!0});const l=e.h3({id:"avtoai-assistant-chat-app-product-info-message-title",style:{color:"var(--avtoai-assistant-colors-text-color)",marginBlockEnd:"0.25em",marginInline:"1.25em",fontWeight:"600"},text:r.displayName}),d=e.p({id:"avtoai-assistant-chat-app-message-card-price",style:{color:"var(--avtoai-assistant-colors-text-color)",marginBlockStart:"0px",marginBottom:"2.25rem",marginInline:"1.25em"},text:this.formatPrice(r.price)}),h=document.createElement("img");h.loading="lazy",h.src=r.imageUrl,h.alt="product-image",e.designComponent(h,{id:"avtoai-assistant-chat-app-product-info-message-image",style:{width:"100%",height:"300px",borderRadius:"10px 10px 0px 0px",objectFit:"cover"}}),c.appendChild(h),c.appendChild(l),c.appendChild(d),o?t.insertBefore(this.content,o):t.appendChild(this.content),this.variants=n,this.selectedVariant=r,this.productHandle=s,this.selectedOptions=[...r.options],this.image=h,this.title=l,this.price=d;const p=this.createOptions(i),g=this.createButtonSection();c.appendChild(p),c.appendChild(g),this.data={index:t.childElementCount,productHandle:s,defaultVariantId:a,variants:n,options:i}}formatPrice(t){return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(t)}createOptions(t){const s=e.div({id:"avtoai-assistant-chat-app-product-info-message-options-container",style:{paddingInline:"1.25em",marginBlockEnd:"1.25em"}});return t.forEach(((t,e)=>{if("title"!==t.name.toLowerCase()||t.values.length>1||!t.values.includes("Default Title")){const a=this.createOption(t,e);s.appendChild(a)}})),s}selectOption(t,s){Array.from(t.parentElement.children).forEach((a=>{a===t?"color"===s?e.designComponent(a,{style:{outline:"3px double var(--avtoai-assistant-colors-text-color)"}}):e.designComponent(a,{style:{opacity:"1"}}):"color"===s?e.designComponent(a,{style:{outline:null}}):e.designComponent(a,{style:{opacity:null}})}))}selectVariant(t,e){this.selectedOptions[e]=t;const s=this.variants.find((t=>t.options.length===this.selectedOptions.length&&t.options.every(((t,e)=>t===this.selectedOptions[e]))));s&&(this.selectedVariant=s,this.image.src=s.imageUrl,this.title.textContent=s.displayName,this.price.textContent=this.formatPrice(s.price))}createOption(t,s){const a=e.div({id:"avtoai-assistant-chat-app-product-info-message-option-container"}),n=e.p({id:"avtoai-assistant-chat-app-product-info-message-option-title",style:{color:"var(--avtoai-assistant-colors-text-color)",fontWeight:"600",fontSize:"12px",marginBlockEnd:"0.25rem"},text:t.name.toUpperCase()}),i=e.div({id:"avtoai-assistant-chat-app-product-info-message-option-wrapper",style:{display:"flex",flexWrap:"wrap"}});return t.values.forEach((a=>{const n="color"===t.name.toLowerCase()||"colour"===t.name.toLowerCase()?"color":"block",o="color"===n?e.div({id:"avtoai-assistant-chat-app-product-info-message-option-color",style:{display:"block",cursor:"pointer",width:"30px",height:"30px",borderRadius:"50%",backgroundColor:a.toLowerCase(),marginBlockEnd:"0.25em",marginInlineEnd:"0.25em"}}):e.div({id:"avtoai-assistant-chat-app-product-info-message-option-other",classes:["avtoai-assistant-button-opacity-hover-4"],style:{minWidth:"50px",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",padding:"0.5rem",color:"var(--avtoai-assistant-colors-text-color)",borderTop:"2px solid var(--avtoai-assistant-colors-text-color)",borderBottom:"2px solid var(--avtoai-assistant-colors-text-color)",borderLeft:0===t.values.indexOf(a)?"2px solid var(--avtoai-assistant-colors-text-color)":"1px solid var(--avtoai-assistant-colors-text-color)",borderRight:t.values.indexOf(a)===t.values.length-1?"2px solid var(--avtoai-assistant-colors-text-color)":"1px solid var(--avtoai-assistant-colors-text-color)",borderRadius:t.values.indexOf(a)===t.values.length-1?"0px 10px 10px 0px":0===t.values.indexOf(a)?"10px 0px 0px 10px":"none"},text:a});i.appendChild(o),o.onclick=t=>{this.selectOption(t.target,n),this.selectVariant(a,s)},this.selectedVariant.options.includes(a)&&this.selectOption(o,n)})),a.appendChild(n),a.appendChild(i),a}createButtonSection(){const t=e.div({id:"avtoai-assistant-chat-app-product-info-message-buttons-container",style:{display:"flex",paddingInline:"1.25em",marginBottom:"1.25em"}}),s=e.button({id:"avtoai-assistant-chat-app-product-info-message-buttons-view-product",classes:["avtoai-assistant-button-scale-hover"],style:{display:"block",cursor:"pointer",width:"50%",paddingInline:"0.25em",paddingBlock:"0.25em",textAlign:"center",border:"1px solid var(--avtoai-assistant-colors-text-color)",marginInlineEnd:"0.25rem",borderRadius:"50px",color:"var(--avtoai-assistant-colors-text-color)",backgroundColor:"var(--avtoai-assistant-colors-message-assistant-bg)"},text:"View Product"}),a=e.button({id:"avtoai-assistant-chat-app-product-info-message-buttons-add-to-cart",classes:["avtoai-assistant-button-scale-hover"],style:{display:"block",cursor:"pointer",width:"50%",paddingInline:"1.25rem",paddingBlock:"1rem",textAlign:"center",border:"1px solid var(--avtoai-assistant-colors-text-color)",borderRadius:"50px",color:"var(--avtoai-assistant-colors-message-assistant-bg)",backgroundColor:"var(--avtoai-assistant-colors-text-color)"},text:"Add to Cart"});return s.onclick=()=>{window.open(window.Shopify.routes.root+`products/${this.productHandle}`)},a.onclick=async()=>{await async function(t,e){const s={items:[{id:parseInt(t),quantity:e}]};try{const t=await fetch(window.Shopify.routes.root+"cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});t.ok?(await t.json(),console.log("Item added to cart")):console.error("Failed to add item to cart. Status code:",t.status)}catch(t){console.error("Error adding item to cart:",t)}}(this.selectedVariant.id,1),window.open(window.Shopify.routes.root+"cart")},t.appendChild(s),t.appendChild(a),t}}function C(t,e){if(e&&0!==e.length)for(let s of e)t.textContent=t.textContent.replace(s.text,"")}function w(t){const e=t.textContent,s=e.match(/product[ _]handle:\s*([^\s]+)/i),a=e.match(/variant[ _]id:\s*(gid:\/\/shopify\/ProductVariant\/\d+)/i);if(s&&a){const[n,i]=s,[o,r]=a;return t.textContent=e.split(n).join("").split(o).map((t=>t.trim())).join(""),{productHandle:i,variantId:r.split("/").pop()}}}async function b({container:t,messages:e,cache:s,staticAddedMessages:a}){const{initConversation:n,newMessages:i}=function(t,e=null,s=0){if(0===t.childElementCount)return{initConversation:!0};for(let e=0;e<s;e++)t.removeChild(t.lastChild);return{initConversation:!1,newMessages:e.length-t.childElementCount}}(t,e,a),o=new m("","user",null,{}).content,r=new m("","assistant",null,{}).content,c=n?e:e.slice(e.length-i,e.length);let l;for(let e=0;e<c.length;e++){const s=c[e],a="assistant"===s.role?r.cloneNode(!0):o.cloneNode(!0);a.children[0].textContent=s.messageText,a.style.marginTop="assistant"===l&&"assistant"===s.role?"0.5em":l?"1em":"0em",l=s.role,t.appendChild(a),"assistant"===s.role&&(C(a.children[0],s.annotations),u(a.children[0]),w(a.children[0]))}s&&function(t,e){const s=Array.from(t.children);for(let a of e){const{index:e,...n}=a,i=s[e];void 0!==i?s.splice(e,0,new y(t,n,i).content):e>=s.length&&s.push(new y(t,n).content)}}(t,s)}class S extends m{constructor(t){const s=e.div({id:"avtoai-assistant-chat-app-message-loading",style:{animation:"avtoai-assistant-spin 2s linear infinite",height:"30px"}});s.innerHTML=n("var(--avtoai-assistant-colors-color-theme)","30px","30px"),super("","assistant",s,{paddingBlock:!0}),t.appendChild(this.content)}}async function E(){const e=document.getElementById("avtoai-assistant-bot-container"),s=document.getElementById("avtoai-assistant-widget-button"),n=e.getAttribute("data-avtoai-color-theme-app"),i=e.getAttribute("data-avotai-theme-app");t(n,i);const o=e.getAttribute("data-avtoai-chat-position"),r=e.getAttribute("data-avtoai-chat-image");e.removeAttribute("data-shop-domain"),e.removeAttribute("data-avtoai-chat-image");const c=new a({container:e,position:o}),l=g("avtoai-assistant-chat-name"),u=g("avtoai-assistant-chat-starters");let m,x;const C=new d({drawer:c,assistantName:l||"Avto AI chatbot Here to help you",assistantStarters:u||["What does this shop sell?"],assistantImage:r,disableForMessageSent:!1},{defaultTheme:i});if(C.onMessageSent=async t=>{g("avtoai-assistant-chat-thread")&&(new v(C.sections.chatSection.content,t,"user"),x=new S(C.sections.chatSection.content),C.sections.chatSection.content.lastChild.scrollIntoView({behavior:"smooth",block:"end"}),m?m.send(t):console.error("No websocket connection"))},!s)return console.error("No widget button element found");s.onclick=async()=>{if(c.isOpen)c.close();else{let e;c.open(),C.switchToLoading();const s=g("avtoai-assistant-chat-thread");if(s){const t=await h.post("/pull/messages",{thread_id:s});e=t.accessUrl,t.messages&&t.messages.length>0&&(C.sections.chatSection.startChat(),b({container:C.sections.chatSection.content,messages:t.messages.reverse(),cache:g("avtoai-assistant-chat-cache")}))}else{const t=await h.get("/create/thread");C.setTitle(t.assistantName),C.setStarters(t.assistantStarters),e=t.accessUrl,p("avtoai-assistant-chat-thread",t.threadId),p("avtoai-assistant-chat-name",t.assistantName),p("avtoai-assistant-chat-starters",t.assistantStarters)}e?(m=await(t=e,new Promise(((e,s)=>{const a=new WebSocket(t);a.onopen=()=>{console.log("connected to AVTO chat"),e(a)},a.onerror=t=>{console.error("AVTO chat error:",t),s(t)}}))),C.switchToReady(),m.onmessage=async t=>{const e=JSON.parse(t.data);if("running"===e.status&&"message_creation"===e.step)x&&x.updateMessage((t=>t+e.chunk));else if("created"===e.status&&"message_creation"===e.step)x&&x.isEmpty()||(x=new S(C.sections.chatSection.content));else if("completed"===e.status&&"no_step"===e.step)C.messageSentReady();else if("created"===e.status&&"code_interpreter"===e.step)x&&x.isEmpty()||(x=new S(C.sections.chatSection.content));else if("done"===e.status&&"code_interpreter"===e.step){const t=await f(e.code);let s=[];t.forEach((t=>s.push(new y(C.sections.chatSection.content,t).data))),p("avtoai-assistant-chat-cache",(t=>[...t,...s]),[])}}):console.error("No access url")}var t}}document.addEventListener("DOMContentLoaded",(()=>{E()}));
